<html class="page-8 app-IMIM" lang="en" style="--js-sticky-top: 204.375px;">

<head>
  <meta http-equiv="x-ua-compatible" content="IE=edge">
  <meta charset="utf-8">
  <title>MEDICINE INDENT</title>

  <link rel="apple-touch-icon" href="../assets/img/app-icon-192.png">
  <link rel="icon" href="../assets/img/app-icon-32.png">

  <link rel="stylesheet" href="../assets/css/Core.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/Theme-Standard.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/font-apex.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/Core_theme.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/custom.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/aos.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/theme.css" type="text/css">
  <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="../assets/vendor/datatable/css/dataTables.css" rel="stylesheet">
  <link rel="stylesheet" href="../assets/vendor/datatable/dataTables.bootstrap5.min.css">
  <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">


  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="-1">
  <meta http-equiv="Cache-Control" content="no-cache">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style type="text/css">
    .t-fht-cell {
      height: 1px;
      overflow: hidden;
    }

    .t-fht-wrapper {
      width: 100%;
      overflow: hidden;
      position: relative;
    }

    .t-fht-thead {
      overflow: hidden;
      position: relative;
    }

    .t-fht-tbody {
      overflow: auto;
    }
  </style>
</head>

<body
  class="t-PageBody t-PageBody--hideLeft t-PageBody--hideActions t-PageTemplate--standard apex-top-nav apex-icons-fontapex apex-theme-vita-standard t-PageBody--topNav js-HeaderExpanded"
  id="t_PageBody" data-aos-easing="ease" data-aos-duration="400" data-aos-delay="0">
  <a href="#main" id="t_Body_skipToContent">Skip to Main Content</a>
  <form>
    <header class="t-Header" id="t_Header" role="banner">
      <div class="t-Header-branding">
        <div class="t-Header-controls">
          <button class="t-Button t-Button--icon t-Button--header t-Button--headerTree" aria-label="Main Navigation"
            title="Main Navigation" id="t_Button_navControl" type="button"><span class="t-Header-controlsIcon"
              aria-hidden="true"></span></button>
        </div>
        <div class="t-Header-logo">
          <!-- <a href="&#x2F;ords&#x2F;r&#x2F;dimdev&#x2F;imim&#x2F;home?session=16050898105778" class="t-Header-logo-link"><img src="r&#x2F;dimdev&#x2F;117&#x2F;files&#x2F;static&#x2F;v194&#x2F;app-251298-logo.jpeg" alt="" class="apex-logo-img" /><span class="apex-logo-text">DIRECTORATE OF INDIAN MEDICINE  - INDENT MANAGEMENT</span></a> -->
          <div class="gigw">
            <li><a data-aos="fade-up" data-aos-delay="200" class="linkedin btn-decrease aos-init aos-animate"><span
                  class="d-inline-block" tabindex="0" data-toggle="tooltip" title="font size Decrease"><i></i> A
                  -</span></a></li>
            <li><a data-aos="fade-up" data-aos-delay="300" class="linkedin btn-orig aos-init aos-animate"><span
                  class="d-inline-block" tabindex="0" data-toggle="tooltip" title="Reset font"><i></i> A
                  <sup></sup></span></a></li>
            <li><a data-aos="fade-up" data-aos-delay="400" class="instagram btn-increase aos-init aos-animate"><span
                  class="d-inline-block" tabindex="0" data-toggle="tooltip" title="font size Increase"><i></i> A
                  +</span></a></li>
            <li><a data-aos="fade-up" data-aos-delay="500" class="aos-init aos-animate"><span class="d-inline-block"
                  tabindex="0" data-toggle="tooltip" title="Dark Mode"><i class="t-Icon fa fa-moon-o"
                    id="darkmode"></i></span></a></li>
            <li><a data-aos="fade-up" data-aos-delay="600" class="form-check form-switch aos-init aos-animate"><label
                  class="form-check-label" for="screenReaderSwitch">
                  <span class="d-inline-block" tabindex="0" data-toggle="tooltip" title="Screen Reader">
                    <i id="sound" class="t-Icon fa fa-volume-up"></i></span></label><input class="form-check-input"
                  type="checkbox" role="switch" id="screenReaderSwitch"
                  onclick="readText(document.getElementsByTagName('body')[0])"></a>
            </li>
          </div>
        </div>
        <div class="t-Header-navBar">
          <div class="t-Header-navBar--start"></div>
          <div id="globalHeader"></div>
          <div class="t-Header-navBar--end"></div>
        </div>
      </div>
      <div class="top">
        <img id="leftlogo" data-aos="fade-right" data-aos-duration="800" src="../assets/img/head-tnlogo.png"
          class="aos-init aos-animate">
        <h1 data-aos="zoom-in" data-aos-duration="800" class="dept-name text-middle aos-init aos-animate">Medicine
          Indent</h1>
        <h3 data-aos="zoom-in" data-aos-duration="800" class="dept-name2 text-middle aos-init aos-animate">Department of
          Indian Medicine and Homoeopathy</h3>
        <img id="rightlogo" data-aos="fade-left" data-aos-duration="800" src="../assets/img/head-dept-logo.png"
          class="aos-init aos-animate">
      </div>
      <div class="t-Header-nav">
        <div class="t-Header-nav-list js-tabLike js-tabLike a-MenuBar a-MenuBar--overflow a-MenuBar--tabs"
          id="t_MenuNav" role="menubar">
          <ul id="nav-links">
            <div id="navbar-container"></div>
          </ul>
        </div>
      </div>
    </header>
    <div class="t-Body">
      <div class="t-Body-main">
        <div class="t-Body-title" id="t_Body_title"></div>
        <div class="t-Body-content" id="t_Body_content">
          <div id="t_Body_content_offset"></div>
          <main id="main" class="t-Body-mainContent">
            <span id="APEX_SUCCESS_MESSAGE" data-template-id="238562751400702882270_S"
              class="apex-page-success u-hidden"></span><span id="APEX_ERROR_MESSAGE"
              data-template-id="238562751400702882270_E" class="apex-page-error u-hidden"></span>
            <div class="t-Body-fullContent"></div>
            <div class="t-Body-contentInner">
              <div class="container">
                <div class="row ">
                  <div class="col col-12 apex-col-auto col-start col-end">
                    <div class="t-Region t-Region--accent12 t-Region--scrollBody" id="R428602256278485590574"
                      role="region" aria-label="MEDICINE INDENT">
                      <div class="t-Region-header">
                        <div class="t-Region-headerItems t-Region-headerItems--title">
                          <span class="t-Region-headerIcon"><span class="t-Icon " aria-hidden="true"></span></span>
                          <h2 class="t-Region-title" id="R428602256278485590574_heading" data-apex-heading="">MEDICINE
                            INDENT</h2>
                        </div>
                        <div class="t-Region-headerItems t-Region-headerItems--buttons"><span
                            class="js-maximizeButtonContainer"></span></div>
                      </div>
                      <div class="t-Region-bodyWrap">
                        <div class="t-Region-buttons t-Region-buttons--top">
                          <div class="t-Region-buttons-left"></div>
                          <div class="t-Region-buttons-right"></div>
                        </div>
                        <div class="t-Region-body">
                          <div class="t-Region-orderBy"></div>
                          <div class="container">
                            <div class="row ">
                              <div class="col col-6 apex-col-auto col-start">
                                <div
                                  class="t-Form-fieldContainer t-Form-fieldContainer--stacked is-required t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--indicatorAsterisk apex-item-wrapper apex-item-wrapper--select-list"
                                  id="P8_NAME_OF_THE_DISTRICT_CONTAINER">
                                  <div class="t-Form-labelContainer">
                                    <label for="P8_NAME_OF_THE_DISTRICT" id="P8_NAME_OF_THE_DISTRICT_LABEL"
                                      class="t-Form-label">Name Of The District </label>
                                  </div>
                                  <div class="t-Form-inputContainer">
                                    <div class="t-Form-itemWrapper">
                                      <select id="P8_NAME_OF_THE_DISTRICT" name="P8_NAME_OF_THE_DISTRICT" required=""
                                        class="selectlist apex-item-select" data-native-menu="false" size="1">
                                      </select>
                                    </div>
                                    <div class="t-Form-itemAssistance">
                                      <span id="P8_NAME_OF_THE_DISTRICT_error_placeholder" class="a-Form-error"
                                        data-template-id="428237131750063931341_ET"></span>
                                      <div class="t-Form-itemRequired" aria-hidden="true">Required</div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="col col-6 apex-col-auto col-end">
                                <div
                                  class="t-Form-fieldContainer t-Form-fieldContainer--stacked is-required t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--indicatorAsterisk apex-item-wrapper apex-item-wrapper--select-list"
                                  id="P8_NAME_OF_THE_INSTITUTION_CONTAINER">
                                  <div class="t-Form-labelContainer">
                                    <label for="P8_NAME_OF_THE_INSTITUTION" id="P8_NAME_OF_THE_INSTITUTION_LABEL"
                                      class="t-Form-label">Name Of The Institution </label>
                                  </div>
                                  <div class="t-Form-inputContainer">
                                    <div class="t-Form-itemWrapper">
                                      <select id="P8_NAME_OF_THE_INSTITUTION" name="P8_NAME_OF_THE_INSTITUTION"
                                        required="" class="selectlist apex-item-select" data-native-menu="false"
                                        size="1">
                                      </select>
                                    </div>
                                    <div class="t-Form-itemAssistance">
                                      <span id="P8_NAME_OF_THE_INSTITUTION_error_placeholder" class="a-Form-error"
                                        data-template-id="428237131750063931341_ET"></span>
                                      <div class="t-Form-itemRequired" aria-hidden="true">Required</div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="row ">
                              <div class="col col-6 apex-col-auto col-start">
                                <div
                                  class="t-Form-fieldContainer t-Form-fieldContainer--stacked is-required t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--indicatorAsterisk apex-item-wrapper apex-item-wrapper--select-list"
                                  id="P8_INSTITUTION_TYPE_CONTAINER">
                                  <div class="t-Form-labelContainer">
                                    <label for="P8_INSTITUTION_TYPE" id="P8_INSTITUTION_TYPE_LABEL"
                                      class="t-Form-label">Institution Type </label>
                                  </div>
                                  <div class="t-Form-inputContainer">
                                    <div class="t-Form-itemWrapper">
                                      <select id="P8_INSTITUTION_TYPE" name="P8_INSTITUTION_TYPE" required=""
                                        class="selectlist apex-item-select" data-native-menu="false" size="1">
                                        <option value="Government">Government</option>
                                      </select>
                                    </div>
                                    <div class="t-Form-itemAssistance">
                                      <span id="P8_INSTITUTION_TYPE_error_placeholder" class="a-Form-error"
                                        data-template-id="428237131750063931341_ET"></span>
                                      <div class="t-Form-itemRequired" aria-hidden="true">Required</div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="col col-6 apex-col-auto col-end">
                                <div
                                  class="t-Form-fieldContainer t-Form-fieldContainer--stacked is-required t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--indicatorAsterisk apex-item-wrapper apex-item-wrapper--has-initial-value apex-item-wrapper--select-list"
                                  id="P8_SYSTEM_CONTAINER">
                                  <div class="t-Form-labelContainer">
                                    <label for="P8_SYSTEM" id="P8_SYSTEM_LABEL" class="t-Form-label">System </label>
                                  </div>
                                  <div class="t-Form-inputContainer">
                                    <div class="t-Form-itemWrapper">
                                      <select id="P8_SYSTEM" name="P8_SYSTEM" required=""
                                        class="selectlist apex-item-select" data-native-menu="false" size="1">

                                      </select>
                                    </div>
                                    <div class="t-Form-itemAssistance">
                                      <span id="P8_SYSTEM_error_placeholder" class="a-Form-error"
                                        data-template-id="428237131750063931341_ET"></span>
                                      <div class="t-Form-itemRequired" aria-hidden="true">Required</div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="row ">
                              <div class="col col-6 apex-col-auto col-start">
                                <div
                                  class="t-Form-fieldContainer t-Form-fieldContainer--stacked is-required t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--indicatorAsterisk apex-item-wrapper apex-item-wrapper--select-list"
                                  id="P8_FINANCIAL_YEAR_CONTAINER">
                                  <div class="t-Form-labelContainer">
                                    <label for="P8_FINANCIAL_YEAR" id="P8_FINANCIAL_YEAR_LABEL"
                                      class="t-Form-label">Financial Year </label>
                                  </div>
                                  <div class="t-Form-inputContainer">
                                    <div class="t-Form-itemWrapper">
                                      <select id="P8_FINANCIAL_YEAR" name="P8_FINANCIAL_YEAR" required=""
                                        class="selectlist apex-item-select" data-native-menu="false" size="1">
                                        <option value="" selected="selected">Select</option>
                                        <option value="2022 - 2023">2022 - 2023</option>
                                        <option value="2023 - 2024">2023 - 2024</option>
                                        <option value="2024 - 2025">2024 - 2025</option>
                                        <option value="2025 - 2026">2025 - 2026</option>
                                      </select>
                                    </div>
                                    <div class="t-Form-itemAssistance">
                                      <span id="P8_FINANCIAL_YEAR_error_placeholder" class="a-Form-error"
                                        data-template-id="428237131750063931341_ET"></span>
                                      <div class="t-Form-itemRequired" aria-hidden="true">Required</div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="col col-6 apex-col-auto col-end">
                                <div
                                  class="t-Form-fieldContainer t-Form-fieldContainer--stacked is-required t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--indicatorAsterisk apex-item-wrapper apex-item-wrapper--select-list"
                                  id="P8_QUARTERS_CONTAINER">
                                  <div class="t-Form-labelContainer">
                                    <label for="P8_QUARTERS" id="P8_QUARTERS_LABEL" class="t-Form-label">Quarters
                                    </label>
                                  </div>
                                  <div class="t-Form-inputContainer">
                                    <div class="t-Form-itemWrapper">
                                      <select id="P8_QUARTERS" name="P8_QUARTERS" required=""
                                        class="selectlist apex-item-select" data-native-menu="false" size="1">
                                        <option value="" selected="selected">Select</option>
                                        <option value="1st Quarter">1st Quarter</option>
                                        <option value="2nd Quarter">2nd Quarter</option>
                                        <option value="3rd Quarter">3rd Quarter</option>
                                        <option value="4th Quarter">4th Quarter</option>
                                        <option value="Annual Indent">Annual Indent</option>
                                      </select>
                                    </div>
                                    <div class="t-Form-itemAssistance">
                                      <span id="P8_QUARTERS_error_placeholder" class="a-Form-error"
                                        data-template-id="428237131750063931341_ET"></span>
                                      <div class="t-Form-itemRequired" aria-hidden="true">Required</div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="row ">
                              <div class="col col-6 apex-col-auto col-start">
                                <div
                                  class="t-Form-fieldContainer t-Form-fieldContainer--stacked is-required t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--indicatorAsterisk apex-item-wrapper apex-item-wrapper--select-list"
                                  id="P8_INDENT_TYPE_CONTAINER">
                                  <div class="t-Form-labelContainer">
                                    <label for="P8_INDENT_TYPE" id="P8_INDENT_TYPE_LABEL" class="t-Form-label">Indent
                                      Type </label>
                                  </div>
                                  <div class="t-Form-inputContainer">
                                    <div class="t-Form-itemWrapper">
                                      <select id="P8_INDENT_TYPE" name="P8_INDENT_TYPE" required=""
                                        class="selectlist apex-item-select" data-native-menu="false" size="1">
                                        <option value="" selected="selected">Select</option>
                                        <option value="Regular">Regular</option>
                                        <option value="Scheme">Scheme</option>
                                      </select>
                                    </div>
                                    <div class="t-Form-itemAssistance">
                                      <span id="P8_INDENT_TYPE_error_placeholder" class="a-Form-error"
                                        data-template-id="428237131750063931341_ET"></span>
                                      <div class="t-Form-itemRequired" aria-hidden="true">Required</div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="col col-6 apex-col-auto col-end" style="display: none;" id="schemeDetails">
                                <div
                                  class="t-Form-fieldContainer t-Form-fieldContainer--stacked t-Form-fieldContainer--stretchInputs apex-item-wrapper apex-item-wrapper--select-list"
                                  id="P8_SCHEME_NAME_CONTAINER">
                                  <div class="t-Form-labelContainer">
                                    <label for="P8_SCHEME_NAME" id="P8_SCHEME_NAME_LABEL" class="t-Form-label">Scheme
                                      Name</label>
                                  </div>
                                  <div class="t-Form-inputContainer">
                                    <div class="t-Form-itemWrapper">
                                      <select id="P8_SCHEME_NAME" name="P8_SCHEME_NAME"
                                        class="selectlist apex-item-select" data-native-menu="false" size="1">
                                        <option value="" selected="selected">Select</option>
                                        <option value="50 Beded Integrated AYUSH Hospitals">50 Beded Integrated AYUSH
                                          Hospitals</option>
                                        <option value="Ayush Health &amp; Wellness Center">Ayush Health &amp; Wellness
                                          Center</option>
                                        <option value="Ayush Wellness">Ayush Wellness</option>
                                        <option value="Co-Location ISM Wings_Upgradation">Co-Location ISM
                                          Wings_Upgradation</option>
                                        <option value="MSD">MSD</option>
                                        <option value="MSK Kit">MSK Kit</option>
                                        <option value="NRHM">NRHM</option>
                                        <option value="Nilavembu Kudineer">Nilavembu Kudineer</option>
                                        <option value="Public Health Out Reach Activities">Public Health Out Reach
                                          Activities</option>
                                        <option value="School Health Programme">School Health Programme</option>
                                        <option value="Tribal Units">Tribal Units</option>
                                      </select>
                                    </div>
                                    <span id="P8_SCHEME_NAME_error_placeholder" class="a-Form-error"
                                      data-template-id="428237130876298931341_ET"></span>
                                  </div>
                                </div>
                              </div>
                            </div>


                            <div class="row" id="allotedDetails" style="display:none;">
                              <div class="col col-6 apex-col-auto col-start">
                                <div
                                  class="t-Form-fieldContainer is-required rel-col t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--indicatorAsterisk t-Form-fieldContainer--large apex-item-wrapper apex-item-wrapper--number-field"
                                  id="P8_ALLOTTED_SCHEME_CONTAINER">
                                  <div class="t-Form-labelContainer col col-2">
                                    <label for="P8_ALLOTTED_SCHEME" id="P8_ALLOTTED_SCHEME_LABEL"
                                      class="t-Form-label">Allotted Scheme Budget </label>
                                  </div>
                                  <div class="t-Form-inputContainer col col-4">
                                    <div class="t-Form-itemWrapper">
                                      <input type="text" id="P8_ALLOTTED_SCHEME" name="P8_ALLOTTED_SCHEME"
                                        class="number_field apex-item-text apex-item-number" value="" size="30"
                                        inputmode="decimal" style="text-align:start" readonly>
                                    </div>
                                    <div class="t-Form-itemAssistance">
                                      <span id="P8_ALLOTTED_SCHEME_error_placeholder" class="a-Form-error"
                                        data-template-id="428237131064519931341_ET"></span>
                                      <div class="t-Form-itemRequired" aria-hidden="true">Required</div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="col col-6 apex-col-auto col-end">
                                <div
                                  class="t-Form-fieldContainer is-required rel-col t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--indicatorAsterisk t-Form-fieldContainer--large apex-item-wrapper apex-item-wrapper--number-field"
                                  id="P8_AVAILABLE_SCHEME_CONTAINER">
                                  <div class="t-Form-labelContainer col col-2">
                                    <label for="P8_AVAILABLE_SCHEME" id="P8_AVAILABLE_SCHEME_LABEL"
                                      class="t-Form-label">Available Scheme Budget </label>
                                  </div>
                                  <div class="t-Form-inputContainer col col-4">
                                    <div class="t-Form-itemWrapper"><input type="text" id="P8_AVAILABLE_SCHEME"
                                        name="P8_AVAILABLE_SCHEME" class="number_field apex-item-text apex-item-number"
                                        value="" size="30" inputmode="decimal" style="text-align:start" readonly>
                                    </div>
                                    <div class="t-Form-itemAssistance">
                                      <span id="P8_AVAILABLE_SCHEME_error_placeholder" class="a-Form-error"
                                        data-template-id="428237131064519931341_ET"></span>
                                      <div class="t-Form-itemRequired" aria-hidden="true">Required</div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="row ">
                              <div class="col col-6 apex-col-auto col-start">
                                <div
                                  class="t-Form-fieldContainer t-Form-fieldContainer--stacked is-required t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--indicatorAsterisk apex-item-wrapper apex-item-wrapper--select-list"
                                  id="P8_MEDICINE_NAME_CONTAINER">
                                  <div class="t-Form-labelContainer">
                                    <label for="P8_MEDICINE_NAME" id="P8_MEDICINE_NAME_LABEL"
                                      class="t-Form-label">Medicine Name </label>
                                  </div>
                                  <div class="t-Form-inputContainer">
                                    <div class="t-Form-itemWrapper">
                                      <select id="P8_MEDICINE_NAME" name="P8_MEDICINE_NAME" required=""
                                        class="selectlist apex-item-select" data-native-menu="false" size="1">
                                        <option value="" selected="selected">Select</option>
                                      </select>
                                    </div>
                                    <div class="t-Form-itemAssistance">
                                      <span id="P8_MEDICINE_NAME_error_placeholder" class="a-Form-error"
                                        data-template-id="428237131750063931341_ET"></span>
                                      <div class="t-Form-itemRequired" aria-hidden="true">Required</div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="col col-6 apex-col-auto col-end">
                                <div
                                  class="t-Form-fieldContainer t-Form-fieldContainer--stacked t-Form-fieldContainer--stretchInputs apex-item-wrapper apex-item-wrapper--select-list"
                                  id="P8_PACKING_SIZE_CONTAINER">
                                  <div class="t-Form-labelContainer">
                                    <label for="P8_PACKING_SIZE" id="P8_PACKING_SIZE_LABEL" class="t-Form-label">Packing
                                      Size</label>
                                  </div>
                                  <div class="t-Form-inputContainer">
                                    <div class="t-Form-itemWrapper"><select id="P8_PACKING_SIZE" name="P8_PACKING_SIZE"
                                        required="" class="selectlist apex-item-select" data-native-menu="false"
                                        size="1"></select></div>
                                    <span id="P8_PACKING_SIZE_error_placeholder" class="a-Form-error"
                                      data-template-id="428237130876298931341_ET"></span>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="row ">
                              <div class="col col-6 apex-col-auto col-start">
                                <div
                                  class="t-Form-fieldContainer t-Form-fieldContainer--stacked is-required t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--indicatorAsterisk apex-item-wrapper apex-item-wrapper--text-field"
                                  id="P8_STOCK_AVAILBLE_CONTAINER">
                                  <div class="t-Form-labelContainer">
                                    <label for="P8_STOCK_AVAILBLE" id="P8_STOCK_AVAILBLE_LABEL"
                                      class="t-Form-label">Availble Stock Quantity </label>
                                  </div>
                                  <div class="t-Form-inputContainer">
                                    <div class="t-Form-itemWrapper"><input type="text" id="P8_STOCK_AVAILBLE"
                                        name="P8_STOCK_AVAILBLE" class="text_field apex-item-text" value="" size="30"
                                        readonly>
                                    </div>
                                    <div class="t-Form-itemAssistance">
                                      <span id="P8_STOCK_AVAILBLE_error_placeholder" class="a-Form-error"
                                        data-template-id="428237131750063931341_ET"></span>
                                      <div class="t-Form-itemRequired" aria-hidden="true">Required</div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="col col-6 apex-col-auto col-end">
                                <div
                                  class="t-Form-fieldContainer t-Form-fieldContainer--stacked t-Form-fieldContainer--stretchInputs apex-item-wrapper apex-item-wrapper--number-field"
                                  id="P8_QUANTITY_CONTAINER">
                                  <div class="t-Form-labelContainer">
                                    <label for="P8_QUANTITY" id="P8_QUANTITY_LABEL" class="t-Form-label">Indenting
                                      Quantity</label>
                                  </div>
                                  <div class="t-Form-inputContainer">
                                    <div class="t-Form-itemWrapper"><input type="text" id="P8_QUANTITY"
                                        name="P8_QUANTITY" required=""
                                        class="number_field apex-item-text apex-item-number" value="" size="32"
                                        maxlength="200" inputmode="decimal" style="text-align:start"></div>
                                    <span id="P8_QUANTITY_error_placeholder" class="a-Form-error"
                                      data-template-id="428237130876298931341_ET"></span>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="row ">
                              <div class="col col-6 apex-col-auto col-start">
                                <div
                                  class="t-Form-fieldContainer t-Form-fieldContainer--stacked t-Form-fieldContainer--stretchInputs apex-item-wrapper apex-item-wrapper--select-list"
                                  id="P8_AMOUNT_CONTAINER">
                                  <div class="t-Form-labelContainer">
                                    <label for="P8_AMOUNT" id="P8_AMOUNT_LABEL" class="t-Form-label">Amount</label>
                                  </div>
                                  <div class="t-Form-inputContainer">
                                    <div class="t-Form-itemWrapper"><input type="text" id="P8_AMOUNT" name="P8_AMOUNT"
                                        required="" class="number_field apex-item-text apex-item-number" value=""
                                        size="30" maxlength="40" inputmode="decimal" style="text-align:start">
                                    </div>
                                    <span id="P8_AMOUNT_error_placeholder" class="a-Form-error"
                                      data-template-id="428237130876298931341_ET"></span>
                                  </div>
                                </div>
                              </div>
                              <div class="col col-6 apex-col-auto col-end">
                                <div
                                  class="t-Form-fieldContainer t-Form-fieldContainer--stacked t-Form-fieldContainer--stretchInputs apex-item-wrapper apex-item-wrapper--number-field"
                                  id="P8_TOTAL_AMOUNT_CONTAINER">
                                  <div class="t-Form-labelContainer">
                                    <label for="P8_TOTAL_AMOUNT" id="P8_TOTAL_AMOUNT_LABEL" class="t-Form-label">Total
                                      Amount</label>
                                  </div>
                                  <div class="t-Form-inputContainer">
                                    <div class="t-Form-itemWrapper"><input type="text" id="P8_TOTAL_AMOUNT"
                                        name="P8_TOTAL_AMOUNT" required=""
                                        class="number_field apex-item-text apex-item-number" value="" size="30"
                                        maxlength="40" inputmode="decimal" style="text-align:start"></div>
                                    <span id="P8_TOTAL_AMOUNT_error_placeholder" class="a-Form-error"
                                      data-template-id="428237130876298931341_ET"></span>
                                  </div>
                                </div>
                                <input type="hidden" name="P8_SNO" id="P8_SNO" value=""><input type="hidden"
                                  name="P8_CREATED_BY" id="P8_CREATED_BY" value=""><input type="hidden"
                                  name="P8_CREATED_DATE" id="P8_CREATED_DATE" value=""><input type="hidden"
                                  name="P8_UPDATED_BY" id="P8_UPDATED_BY" value=""><input type="hidden"
                                  name="P8_UPDATED_DATE" id="P8_UPDATED_DATE" value=""><input type="hidden"
                                  name="P8_STATUS" id="P8_STATUS" value=""><input type="hidden"
                                  name="P8_INSTITUTION_TYPE_1" id="P8_INSTITUTION_TYPE_1" value="">
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="t-Region-buttons t-Region-buttons--bottom">
                          <div class="t-Region-buttons-left"><a href="../amo/home.html"
                              class="t-Button js-ignoreChange u-color-12" type="button"
                              id="B428602260732472590578"><span class="t-Button-label">BACK</span></a></div>
                          <button type="submit" form="patientForm" id="submitBtn"
                            class="t-button btn-bgclr">Add</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row ">
                  <div class="col col-12 apex-col-auto col-start col-end">
                    <div class="t-Region t-Region--scrollBody" id="R330520909914876140317" role="region"
                      aria-label="List of Medicines">
                      <div class="t-Region-header">
                        <div class="t-Region-headerItems t-Region-headerItems--title">
                          <span class="t-Region-headerIcon"><span class="t-Icon " aria-hidden="true"></span></span>
                          <h2 class="t-Region-title" id="R330520909914876140317_heading" data-apex-heading="">List of
                            Medicines</h2>
                        </div>
                        <div class="t-Region-headerItems t-Region-headerItems--buttons"><span
                            class="js-maximizeButtonContainer"></span></div>
                      </div>
                      <div class="t-Region-bodyWrap">
                        <div class="t-Region-buttons t-Region-buttons--top">
                          <div class="t-Region-buttons-left"></div>
                          <div class="t-Region-buttons-right"></div>
                        </div>
                        <div class="t-Region-body">
                          <div class="t-Region-orderBy"></div>
                          <div class="container">
                            <div class="row ">
                              <div class="col col-6 apex-col-auto col-start">
                                <div
                                  class="t-Form-fieldContainer rel-col t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--large apex-item-wrapper apex-item-wrapper--display-only"
                                  id="GRAND_TOTAL_CONTAINER">
                                  <div class="t-Form-labelContainer col col-2">
                                    <label for="GRAND_TOTAL" id="GRAND_TOTAL_LABEL" class="t-Form-label">Grand
                                      Total</label>
                                  </div>
                                  <div class="t-Form-inputContainer col col-4">
                                    <div class="t-Form-itemWrapper"><input type="hidden" id="GRAND_TOTAL"
                                        name="GRAND_TOTAL" value=""><input type="hidden" data-for="GRAND_TOTAL"
                                        value="DJq9Tl1yhuQ2XF732DJAI_qNIYeXCIQCVoEGNECHzmUWtdBuHlbUxMpavRR0auMhqBR3hmDFFr3bbKrw9-dNDg"><span
                                        id="GRAND_TOTAL_DISPLAY" class="display_only apex-item-display-only"
                                        data-escape="true"></span></div>
                                    <span id="GRAND_TOTAL_error_placeholder" class="a-Form-error"
                                      data-template-id="428237130780249931341_ET"></span>
                                  </div>
                                </div>
                              </div>
                              <div class="col col-6 apex-col-auto col-end">
                                <div
                                  class="t-Form-fieldContainer rel-col t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--large apex-item-wrapper apex-item-wrapper--display-only"
                                  id="TOTAL_QTY_CONTAINER">
                                  <div class="t-Form-labelContainer col col-2">
                                    <label for="TOTAL_QTY" id="TOTAL_QTY_LABEL" class="t-Form-label">Total
                                      Quantity</label>
                                  </div>
                                  <div class="t-Form-inputContainer col col-4">
                                    <div class="t-Form-itemWrapper"><input type="hidden" id="TOTAL_QTY" name="TOTAL_QTY"
                                        value=""><input type="hidden" data-for="TOTAL_QTY"
                                        value="dLFNOUDfJEKcoysY3dDzYT6NuEBVm_M1N71UyqAVerTrPmoQ6c6MzVB1KThj259AV5AmHap2ipav5BDyMZORHQ"><span
                                        id="TOTAL_QTY_DISPLAY" class="display_only apex-item-display-only"
                                        data-escape="true"></span></div>
                                    <span id="TOTAL_QTY_error_placeholder" class="a-Form-error"
                                      data-template-id="428237130780249931341_ET"></span>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="row ">
                              <div class="col col-12 apex-col-auto col-start col-end">
                                <div id="R329057930817690592218" role="region" aria-label="Medicine Details"
                                  class="t-IRR-region js-apex-region">
                                  <div class="t-Region-orderBy"></div>
                                  <input type="hidden" name="P8_ROW_DELETE" id="P8_ROW_DELETE" value=""><input
                                    type="hidden" name="P8_NAME" id="P8_NAME" value=""><input type="hidden"
                                    name="P8_INS_TYPE" id="P8_INS_TYPE" value=""><input type="hidden" name="P8_INS"
                                    id="P8_INS" value="">
                                  <div id="R329057930817690592218_ir" class="a-IRR-container">
                                    <div id="R329057930817690592218_worksheet_region" class="a-IRR" aria-live="polite">
                                      <div id="R329057930817690592218_single_row_view" class="a-IRR-singleRowView">
                                      </div>
                                      <div id="R329057930817690592218_full_view" class="a-IRR-fullView">
                                        <div id="R329057930817690592218_toolbar" class="a-IRR-toolbar">
                                          <div role="search" aria-label="Search bar of Medicine Details"
                                            id="R329057930817690592218_toolbar_controls" class="a-IRR-controls">
                                            <div
                                              class="a-IRR-controlGroup a-IRR-controlGroup--search a-IRR-controlGroup--hidden">
                                              <div class="a-IRR-search"><input type="hidden"
                                                  id="R329057930817690592218_column_search_current_column"><input
                                                  type="hidden" id="R329057930817690592218_search_field" value=""></div>
                                            </div>
                                            <div class="a-IRR-controlGroup a-IRR-controlGroup--views"></div>
                                            <div class="a-IRR-controlGroup a-IRR-controlGroup--options">
                                              <input type="hidden" id="R329057930817690592218_row_select" value="50">
                                              <div class="a-IRR-actions"><button
                                                  id="R329057930817690592218_actions_button"
                                                  class="a-Button a-IRR-button a-IRR-button--actions" type="button"
                                                  data-menu="R329057930817690592218_actions_menu"
                                                  aria-haspopup="menu">Actions<span aria-hidden="true"
                                                    class="a-Icon icon-menu-drop-down"></span></button></div>
                                            </div>
                                          </div>
                                        </div>
                                        <div id="R329057930817690592218_content" class="a-IRR-content ">
                                          <div id="R329057930817690592218_dialog_js" class="a-IRR-dialogBody"
                                            style="display:none"></div>
                                          <input type="hidden" id="R329057930817690592218_worksheet_id"
                                            value="280999630590791532442">
                                          <input type="hidden" id="R329057930817690592218_app_user" value="9994793279">
                                          <input type="hidden" id="R329057930817690592218_report_id"
                                            value="282584343589325120460">
                                          <input type="hidden" id="R329057930817690592218_view_mode" value="REPORT">
                                          <style id="R329057930817690592218_worksheet_css" type="text/css"></style>
                                          <div role="region" aria-label="Chart view of Medicine Details"
                                            id="R329057930817690592218_chart" class="a-IRR-chartView"></div>
                                          <div role="region" aria-label="Group by view of Medicine Details"
                                            id="R329057930817690592218_group_by" class="a-IRR-groupByView"></div>
                                          <div role="region" aria-label="Pivot view of Medicine Details"
                                            id="R329057930817690592218_pivot" class="a-IRR-pivotView"></div>
                                          <div role="region" aria-label="Data view of Medicine Details"
                                            id="R329057930817690592218_data_panel" class="a-IRR-reportView">
                                            <div role="region" aria-label="Message" class="a-IRR-noDataMsg">
                                              <div class="a-IRR-noDataMsg-icon"><span class="a-Icon icon-irr-no-results"
                                                  aria-hidden="true"></span></div>
                                              <span class="a-IRR-noDataMsg-text"></span>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="row ">
                              <div class="col col-5  col-start"><span class="apex-grid-nbsp">&nbsp;</span></div>
                              <div class="col col-2  "><button onclick=""
                                  class="t-Button u-color-12  t-Button--gapTop t-Button--gapBottom" type="button"
                                  id="B330520909614981140314"><span class="t-Button-label">Place Indent</span></button>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="t-Region-buttons t-Region-buttons--bottom">
                          <div class="t-Region-buttons-left"></div>
                          <div class="t-Region-buttons-right"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </main>
          <footer class="t-Footer" id="t_Footer" role="contentinfo">
            <div class="t-Footer-body">
              <div class="t-Footer-content"></div>
              <div class="t-Footer-apex">
                <!-- <div class="t-Footer-version">    </div>
                    <div class="t-Footer-customize"></div>
                     -->
                <div class="row">
                  <div class="col-6">
                    <p class="text-middle"><img class="footer-logo" src="../assets/img/head-dept-logo.png"><br>Content
                      owned by Department of Indian Medicine and Homoeopathy ©</p>
                  </div>
                  <div class="col-6">
                    <p class="text-middle"><img class="footer-logo" src="../assets/img/tnegalogo.png"><br>Designed and
                      Developed by Tamil Nadu e-Governance Agency</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="t-Footer-top">
              <a href="#top" class="t-Footer-topButton" id="t_Footer_topButton" title="Start of page"
                aria-label="Start of page"><span class="a-Icon icon-up-chevron" aria-hidden="true"></span></a>
            </div>
          </footer>
        </div>
      </div>
    </div>
    <div class="t-Body-inlineDialogs" id="t_Body_inlineDialogs"></div>
    <input type="hidden" id="pPageFormRegionChecksums" value="[]">
    <input type="hidden" id="pPageItemsRowVersion" value=""><input type="hidden" id="pPageItemsProtected"
      value="R1JBTkRfVE9UQUw6VE9UQUxfUVRZ/RbkeFYEepRmNoFtsQKaXKq5924O9zVirJojNaiw_gfZRuxrbv2Auo9eVPuI1rG4_URzL44XOGiTXyO2MsjcU1Q">
  </form>
  <!-- jQuery -->
  <script src="../assets/js/jquery-3.6.0.min.js"></script>
  <script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- DataTables -->
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script src="../assets/js/widget.treeView.min.js"></script>
  <script src="../assets/common.js"></script>
  <script src="../assets/js/widget.interactiveReport.min.js"></script>
  <script src="../assets/js/widget.iconList.min.js"></script>
  <script src="../assets/js/widget.stickyTableHeader.min.js"></script>
  <script src="../assets/js/widget.stickyWidget.min.js"></script>
  <script src="../assets/js/item.Colorpicker.min.js"></script>
  <script src="../assets/js/jetCommonBundle.min.js"></script>
  <script src="../assets/js/chartBundle.min.js"></script>

  <script src="../assets/js/toastUtil.js"></script>
  <script src="../assets/js/validation.js"></script>
  <script type="module" src="../assets/js/dataTableUtil.js"></script>
  <script src="../assets/js/crypto-js.min.js"></script>
  <script src="../assets/js/theme42.min.js"></script>
  <script src="../assets/js/global.js"></script>
  <script src="../assets/js/encrypt_decrypt.js"></script>
  <script src="../assets/js/singleFileUpload.js"></script>
  <script src="../assets/js/globalHeader.js"></script>
  <script src="../assets/js/validateField.js"></script>

  <script>
    let dataTableRef;

    $(document).ready(function () {
      let uploadFile = null;
      let uploadPayload = null;
      const apiUrl = 'https://tngis.tnega.org/medical_indent_api/v1/commonfunction';
      // const userId = localStorage.getItem('userId');
      // const secretKey = 'V7gN4dY8pT2xB3kRz';
      // const district = localStorage.getItem('userDistrict');
      // const username = localStorage.getItem('userName');
      // const mobnumber = localStorage.getItem('userMob');


      const district = localStorage.getItem('userDistrict');
      const nameOfTheInstitution = localStorage.getItem('userInstitutionName');
      const system = localStorage.getItem('userSystem');

      // Populate district dropdown
      if (district) {
        const districtSelect = $('#P8_NAME_OF_THE_DISTRICT');
        districtSelect.append(`<option value="${district}" selected>${district}</option>`);
      } else {
        console.warn('District not found in localStorage');
      }

      // Populate institution dropdown
      if (nameOfTheInstitution) {
        const nameOfTheInstitutionSelect = $('#P8_NAME_OF_THE_INSTITUTION');
        nameOfTheInstitutionSelect.append(`<option value="${nameOfTheInstitution}" selected>${nameOfTheInstitution}</option>`);
      } else {
        console.warn('Institution not found in localStorage');
      }

      // Populate system dropdown
      if (system) {
        const systemSelect = $('#P8_SYSTEM');
        systemSelect.append(`<option value="${system}" selected>${system}</option>`);
      } else {
        console.warn('System not found in localStorage');
      }

      // Utility: Fetch and populate dropdown
      function fetchAndPopulateDropdown({ payload, dropdownId, placeholder }) {
        $.ajax({
          url: apiUrl,
          method: 'POST',
          headers: {
            'X-APP-Key': 'edm',
            'X-APP-Name': 'edm'
          },
          data: {
            data: encryptData(payload)
          },
          dataType: 'json',
          success(response) {
            const decrypted = decryptData(response.data);
            console.log(`Decrypted Data for ${payload.function_name}:`, decrypted);

            const $dropdown = $(`#${dropdownId}`);
            $dropdown.empty().append(`<option value="">${placeholder}</option>`);

            decrypted.forEach(item => {
              const value = item.p_institude || item.p_size || item.im_medicine_price_fn || item.gender || item.medicine;
              $dropdown.append(`<option value="${value}">${value}</option>`);
            });
          },
          error(xhr, status, error) {
            console.error(`${payload.function_name} API Error:`, error);
          }
        });
      }

      // 🚀 Call medicine API if institution is available
      if (nameOfTheInstitution) {
        fetchAndPopulateDropdown({
          payload: {
            action: "function_call",
            function_name: "im_medicine_name_fn",
            params: { institution_name: nameOfTheInstitution }
          },
          dropdownId: "P8_MEDICINE_NAME",
          placeholder: "--Select Medicine Name--"
        });
      }

      $('#P8_MEDICINE_NAME').off('change').on('change', function () {
        $('#P8_AMOUNT').val('');
        $('#P8_STOCK_AVAILBLE').val('');
        const selectedMedicine = $(this).val();

        if (selectedMedicine) {
          fetchAndPopulateDropdown({
            payload: {
              action: "function_call",
              function_name: "im_pack_size_fn",
              params: { institution_name: selectedMedicine }
            },
            dropdownId: "P8_PACKING_SIZE",
            placeholder: "--Select Packing size--"
          });
        } else {
          // Clear medicine dropdown if no institution selected
          $('#P8_PACKING_SIZE').empty().append('<option value="">--Select Medicine--</option>');
        }
      });


      $('#P8_PACKING_SIZE').off('change').on('change', function () {
        $('#P8_AMOUNT').val('');
        $('#P8_STOCK_AVAILBLE').val('');

        const selectedMedicine = $('#P8_MEDICINE_NAME').val();
        const selectedInstitution = $('#P8_NAME_OF_THE_INSTITUTION').val();
        const selectedPackSize = $(this).val();

        if (selectedMedicine) {
          $.ajax({
            url: apiUrl,
            method: 'POST',
            headers: {
              'X-APP-Key': 'edm',
              'X-APP-Name': 'edm'
            },
            data: {
              data: encryptData({
                action: "function_call",
                function_name: "im_medicine_price_fn",
                params: { p_medicine_name: selectedMedicine, p_pack_size: selectedPackSize }
              })
            },
            dataType: 'json',
            success(response) {
              const decrypted = decryptData(response.data);
              console.log("Decrypted Amount Data:", decrypted);

              if (Array.isArray(decrypted) && decrypted.length > 0) {
                const amount = decrypted[0].im_medicine_price_fn || '';
                $('#P8_AMOUNT').val(amount); // Set value in input field
              } else {
                $('#P8_AMOUNT').val('');
              }
            },
            error(xhr, status, error) {
              console.error("im_medicine_price_fn API Error:", error);
              $('#P8_AMOUNT').val('');
            }
          });
        } else {
          $('#P8_AMOUNT').val('');
        }
        if (selectedPackSize) {
          $.ajax({
            url: apiUrl,
            method: 'POST',
            headers: {
              'X-APP-Key': 'edm',
              'X-APP-Name': 'edm'
            },
            data: {
              data: encryptData({
                action: "function_call",
                function_name: "im_avl_stock_fn",
                params: { p_medicine_name: selectedMedicine, p_institution: selectedInstitution, p_pack_size: selectedPackSize }
              })
            },
            dataType: 'json',
            success(response) {
              const decrypted = decryptData(response.data);
              console.log("Decrypted Amount Data:", decrypted);

              if (Array.isArray(decrypted) && decrypted.length > 0) {
                const amount = decrypted[0].im_avl_stock_fn || '';
                $('#P8_STOCK_AVAILBLE').val(amount); // Set value in input field
              } else {
                $('#P8_STOCK_AVAILBLE').val('');
              }
            },
            error(xhr, status, error) {
              console.error("im_avl_stock_fn API Error:", error);
              $('#P8_STOCK_AVAILBLE').val('');
            }
          });
        } else {
          $('#P8_STOCK_AVAILBLE').val('');
        }


      });
      // $('#P8_INDENT_TYPE').on('change', function () {
      //   const indentTypeValue = $('#P8_INDENT_TYPE').val(); // Gets selected value
      //   const indentTypeText = $('#P8_INDENT_TYPE option:selected').text().trim().toLowerCase(); // Gets selected text

      //   const allotedDetails = document.getElementById('allotedDetails');
      //   const schemeDetails = document.getElementById('schemeDetails');

      //   if (indentTypeText === "regular") {
      //     (schemeDetails).hide();
      //     allotedDetails.show();
      //   } else {
      //     schemeDetails.show();
      //     allotedDetails.show();
      //   }
      // });
      $('#P8_INDENT_TYPE').on('change', function () {
        const indentTypeText = $('#P8_INDENT_TYPE option:selected').text().trim();
        const $allotedDetails = $('#allotedDetails');
        const $schemeDetails = $('#schemeDetails');
        const $schemeDropdown = $('#P8_SCHEME_NAME');

        // Reset values
        $('#P8_ALLOTTED_SCHEME').val('');
        $('#P8_AVAILABLE_SCHEME').val('');
        $schemeDropdown.empty().append('<option value="">Select Scheme</option>');

        // Get local storage values
        const district = localStorage.getItem('userDistrict');
        const nameOfTheInstitution = localStorage.getItem('userInstitutionName');
        const system = localStorage.getItem('userSystem');

        if (!district || !nameOfTheInstitution || !system || !indentTypeText) {
          console.warn("Missing required parameters");
          return;
        }

        if (indentTypeText.toLowerCase() === "regular") {
          // Regular - hide scheme dropdown
          $schemeDetails.hide();
          $allotedDetails.show();

          // Call im_regular_scheme_all_avl_fn with null scheme
          const payload = {
            action: "function_call",
            function_name: "im_regular_scheme_all_avl_fn",
            params: [district, nameOfTheInstitution, system, null, indentTypeText]
          };

          callIndentDetailsAPI(payload);

        } else if (indentTypeText.toLowerCase() === "scheme") {
          // Scheme - show dropdown and fetch schemes
          $schemeDetails.show();
          $allotedDetails.show();

          const schemePayload = {
            action: "function_call",
            function_name: "im_scheme_name_fn",
            params: {}
          };

          $.ajax({
            url: apiUrl,
            method: 'POST',
            headers: {
              'X-APP-Key': 'edm',
              'X-APP-Name': 'edm'
            },
            data: {
              data: encryptData(schemePayload)
            },
            dataType: 'json',
            success(response) {
              const decrypted = decryptData(response.data);
              if (Array.isArray(decrypted)) {
                decrypted.forEach(item => {
                  const schemeName = item.scheme || item.scheme; // adjust key name if different
                  $schemeDropdown.append(`<option value="${schemeName}">${schemeName}</option>`);
                });
              }
            },
            error(xhr, status, error) {
              console.error(`Error fetching schemes:`, error);
            }
          });
        }
      });

      // When scheme name changes (only for 'Scheme' indent type)
      $('#P8_SCHEME_NAME').on('change', function () {
        const selectedScheme = $(this).val();
        const indentTypeText = $('#P8_INDENT_TYPE option:selected').text().trim();
        const district = localStorage.getItem('userDistrict');
        const nameOfTheInstitution = localStorage.getItem('userInstitutionName');
        const system = localStorage.getItem('userSystem');

        if (!selectedScheme || !district || !nameOfTheInstitution || !system) return;

        const payload = {
          action: "function_call",
          function_name: "im_regular_scheme_all_avl_fn",
          params: [district, nameOfTheInstitution, system, selectedScheme, indentTypeText]
        };

        callIndentDetailsAPI(payload);
      });

      function callIndentDetailsAPI(payload) {
        $.ajax({
          url: apiUrl,
          method: 'POST',
          headers: {
            'X-APP-Key': 'edm',
            'X-APP-Name': 'edm'
          },
          data: {
            data: encryptData(payload)
          },
          dataType: 'json',
          success(response) {
            const decrypted = decryptData(response.data);
            if (Array.isArray(decrypted)) {
              decrypted.forEach(item => {
                const lowerName = item.name.toLowerCase();
                if (lowerName.includes("allotted")) {
                  $('#P8_ALLOTTED_SCHEME').val(item.available);
                }
                if (lowerName.includes("available")) {
                  $('#P8_AVAILABLE_SCHEME').val(item.available);
                }
              });
            }
          },
          error(xhr, status, error) {
            console.error(`${payload.function_name} API Error:`, error);
          }
        });
      }

      $('#submitBtn').on('click', async function (event) {
        event.preventDefault();
        $('.field-error').remove();

        var district = $('#P8_NAME_OF_THE_DISTRICT').val()?.trim();
        var nameOfTheInstitution = $('#P8_NAME_OF_THE_INSTITUTION').val()?.trim();
        var institutionType = $('#P8_INSTITUTION_TYPE').val()?.trim();
        var system = $('#P8_SYSTEM').val()?.trim();
        var financialYear = $('#P8_FINANCIAL_YEAR').val()?.trim();
        var quarters = $('#P8_QUARTERS').val()?.trim();
        var indentType = $('#P8_INDENT_TYPE').val()?.trim();
        var medicineName = $('#P8_MEDICINE_NAME').val()?.trim();
        var packingSize = $('#P8_PACKING_SIZE').val()?.trim();
        var stockAvailable = $('#P8_STOCK_AVAILBLE').val()?.trim();
        var quantity = $('#P8_QUANTITY').val()?.trim();
        var amount = $('#P8_AMOUNT').val()?.trim();
        var totalAmount = $('#P8_TOTAL_AMOUNT').val()?.trim();
        var schemeName = $('#P8_SCHEME_NAME').val()?.trim();
        // Basic validation function
        function showError(selector, message) {
          $(selector).after(`<div class="field-error" style="color:red;font-size:12px;">${message}</div>`);
        }

        let isValid = true;

        isValid &= window.validation.validateRequiredField('#P8_NAME_OF_THE_DISTRICT', district, 'District');
        isValid &= window.validation.validateRequiredField('#P8_NAME_OF_THE_INSTITUTION', nameOfTheInstitution, 'Institution name');
        isValid &= window.validation.validateRequiredField('#P8_INSTITUTION_TYPE', institutionType, 'Institution Type');
        isValid &= window.validation.validateRequiredField('#P8_SYSTEM', system, 'System');
        isValid &= window.validation.validateRequiredField('#P8_FINANCIAL_YEAR', financialYear, 'Financial Year');
        isValid &= window.validation.validateRequiredField('#P8_QUARTERS', quarters, 'Quarters');
        isValid &= window.validation.validateRequiredField('#P8_INDENT_TYPE', indentType, 'Indent Type');
        isValid &= window.validation.validateRequiredField('#P8_MEDICINE_NAME', medicineName, 'Medicine Name');
        isValid &= window.validation.validateRequiredField('#P8_PACKING_SIZE', packingSize, 'Packing Size');
        isValid &= window.validation.validateRequiredField('#P8_STOCK_AVAILBLE', stockAvailable, 'Stock Available');
        isValid &= window.validation.validateRequiredField('#P8_QUANTITY', quantity, 'Quantity');
        isValid &= window.validation.validateRequiredField('#P8_AMOUNT', amount, 'Amount');
        isValid &= window.validation.validateRequiredField('#P8_TOTAL_AMOUNT', totalAmount, 'Total Amount');

        if (!isValid) return;

        // Prepare payload with correct params
        const payload = {
          action: "procedure_call",
          procedure_name: "im_medicine_details_ins_sp",
          params: {
            p_medicine_name: medicineName,
            p_pack_size: packingSize,
            p_quantity: quantity,
            p_total_amount: totalAmount,
            p_type: indentType,
            p_institution: nameOfTheInstitution,
            p_quarters: quarters,
            p_created_by: localStorage.getItem('userMobileNumber') || '9994793279',
            p_financial_year: financialYear,
            p_district: district,
            p_system: system,
            p_scheme: schemeName,
            p_institution_type: institutionType,
            p_stock: stockAvailable

          }
        };

        // API call
        $.ajax({
          url: apiUrl,
          method: "POST",
          headers: {
            'X-APP-Key': "edm",
            'X-APP-Name': "edm"
          },
          data: {
            data: encryptData(payload)
          },
          dataType: 'json',
          cache: false,
          success: function (response) {
            alert("Inserted Successfully");
          },
          error: function (xhr, status, error) {
            showErrorToast("Failed to insert data. Please try again.");
            console.error("API call failed:", {
              status: xhr.status,
              statusText: xhr.statusText,
              responseText: xhr.responseText,
              error: error
            });
          }
        });

        console.log(payload);
      });


    });
  </script>
</body>

</html>