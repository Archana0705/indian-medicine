<html class="page-39 app-IMIM" lang="en" style="--js-sticky-top: 204.375px;">

<head>
  <meta http-equiv="x-ua-compatible" content="IE=edge">
  <meta charset="utf-8">
  <title>Medicine Details</title>

  <link rel="apple-touch-icon" href="../assets/img/app-icon-192.png">
  <link rel="icon" href="../assets/img/app-icon-32.png">

  <link rel="stylesheet" href="../assets/css/Core.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/Theme-Standard.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/font-apex.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/Core_theme.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/custom.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/aos.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/theme.css" type="text/css">


  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="-1">
  <meta http-equiv="Cache-Control" content="no-cache">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    .dataTables_paginate {
      display: flex;
      justify-content: center;
      margin-top: 1rem;
      gap: 5px;
    }

    .paginate_button {
      background-color: #f2f2f2;
      border: 1px solid #ccc;
      padding: 6px 12px;
      margin: 0 2px;
      border-radius: 4px;
      color: #333;
      text-decoration: none;
      cursor: pointer;
      font-size: 14px;
      transition: background-color 0.2s ease;
    }

    .paginate_button:hover:not(.disabled),
    .paginate_button:focus {
      background-color: #007bff;
      color: white;
    }

    .paginate_button.current {
      background-color: #007bff;
      color: white;
      font-weight: bold;
    }

    .paginate_button.disabled {
      cursor: not-allowed;
      opacity: 0.5;
    }
  </style>
</head>

<body
  class="t-PageBody t-PageBody--hideLeft t-PageBody--hideActions t-PageTemplate--standard apex-top-nav apex-icons-fontapex apex-theme-vita-standard js-HeaderExpanded t-PageBody--topNav"
  id="t_PageBody" data-aos-easing="ease" data-aos-duration="400" data-aos-delay="0">
  <a href="#main" id="t_Body_skipToContent">Skip to Main Content</a>
  <form method="post" name="wwv_flow" id="wwvFlowForm" data-oj-binding-provider="none" novalidate="" autocomplete="off">
    <input type="hidden" name="p_flow_id" value="117" id="pFlowId"><input type="hidden" name="p_flow_step_id" value="39"
      id="pFlowStepId"><input type="hidden" name="p_instance" value="2368821413423" id="pInstance"><input type="hidden"
      name="p_page_submission_id" value="141246389646053900712494422662255880324" id="pPageSubmissionId"><input
      type="hidden" name="p_request" value="" id="pRequest"><input type="hidden" name="p_reload_on_submit" value="S"
      id="pReloadOnSubmit"><input type="hidden" value="imim/medicine-details4/2368821413423" id="pContext"><input
      type="hidden" value="141246389646053900712494422662255880324" id="pSalt">
    <header class="t-Header" id="t_Header" role="banner">
      <div class="t-Header-branding">
        <div class="t-Header-controls">
          <button class="t-Button t-Button--icon t-Button--header t-Button--headerTree" aria-label="Main Navigation"
            title="Main Navigation" id="t_Button_navControl" type="button"><span class="t-Header-controlsIcon"
              aria-hidden="true"></span></button>
        </div>
        <div class="t-Header-logo">
          <!-- <a href="&#x2F;ords&#x2F;r&#x2F;dimdev&#x2F;imim&#x2F;home?session=2368821413423" class="t-Header-logo-link"><img src="r&#x2F;dimdev&#x2F;117&#x2F;files&#x2F;static&#x2F;v194&#x2F;app-251298-logo.jpeg" alt="" class="apex-logo-img" /><span class="apex-logo-text">DIRECTORATE OF INDIAN MEDICINE  - INDENT MANAGEMENT</span></a> -->
          <div class="gigw">
            <li><a data-aos="fade-up" data-aos-delay="200" class="linkedin btn-decrease aos-init aos-animate"><span
                  class="d-inline-block" tabindex="0" data-toggle="tooltip" title="font size Decrease"><i></i> A
                  -</span></a></li>
            <li><a data-aos="fade-up" data-aos-delay="300" class="linkedin btn-orig aos-init aos-animate"><span
                  class="d-inline-block" tabindex="0" data-toggle="tooltip" title="Reset font"><i></i> A
                  <sup></sup></span></a></li>
            <li><a data-aos="fade-up" data-aos-delay="400" class="instagram btn-increase aos-init aos-animate"><span
                  class="d-inline-block" tabindex="0" data-toggle="tooltip" title="font size Increase"><i></i> A
                  +</span></a></li>
            <li><a data-aos="fade-up" data-aos-delay="500" class="aos-init aos-animate"><span class="d-inline-block"
                  tabindex="0" data-toggle="tooltip" title="Dark Mode"><i class="t-Icon fa fa-moon-o"
                    id="darkmode"></i></span></a></li>
            <li><a data-aos="fade-up" data-aos-delay="600" class="form-check form-switch aos-init aos-animate"><label
                  class="form-check-label" for="screenReaderSwitch">
                  <span class="d-inline-block" tabindex="0" data-toggle="tooltip" title="Screen Reader">
                    <i id="sound" class="t-Icon fa fa-volume-up"></i></span></label><input class="form-check-input"
                  type="checkbox" role="switch" id="screenReaderSwitch"
                  onclick="readText(document.getElementsByTagName('body')[0])"></a>
            </li>
          </div>
        </div>
        <div class="t-Header-navBar">
          <div class="t-Header-navBar--start"></div>
          <div class="t-Header-navBar--center">
            <ul class="t-NavigationBar " id="428237243222882931397">
              <li class="t-NavigationBar-item ">
                <button class="t-Button t-Button--icon t-Button t-Button--header t-Button--navBar" type="button"
                  id="username" data-menu="menu_L428237300758551931558" title="" aria-haspopup="menu">
                  <span class="t-Icon fa fa-user" aria-hidden="true"></span><span class="t-Button-label"></span><span
                    class="t-Button-badge"></span><span class="a-Icon icon-down-arrow" aria-hidden="true"></span>
                </button>
              </li>
            </ul>
          </div>
          <div class="t-Header-navBar--end"></div>
        </div>
      </div>
      <div class="top">
        <img id="leftlogo" data-aos="fade-right" data-aos-duration="800" src="../assets/img/head-tnlogo.png"
          class="aos-init aos-animate">
        <h1 data-aos="zoom-in" data-aos-duration="800" class="dept-name text-middle aos-init aos-animate">Medicine
          Indent</h1>
        <h3 data-aos="zoom-in" data-aos-duration="800" class="dept-name2 text-middle aos-init aos-animate">Department of
          Indian Medicine and Homoeopathy</h3>
        <img id="rightlogo" data-aos="fade-left" data-aos-duration="800" src="../assets/img/head-dept-logo.png"
          class="aos-init aos-animate">
      </div>
      <div class="t-Header-nav">
        <div class="t-Header-nav-list js-tabLike js-tabLike a-MenuBar a-MenuBar--overflow a-MenuBar--tabs"
          id="t_MenuNav" role="menubar">
          <ul role="none">
            <li role="none" id="t_MenuNav_0" class="a-MenuBar-item a-Menu--current"><a role="menuitem"
                class="a-MenuBar-label" aria-current="true" id="t_MenuNav_0i" href="../dim/home.html">Home</a></li>
            <li role="none" id="t_MenuNav_1" class="a-MenuBar-item"><a role="menuitem" class="a-MenuBar-label"
                id="t_MenuNav_1i" href="../dim/received-medicine.html" tabindex="-1">Received Medicine Report</a></li>
            <li role="none" id="t_MenuNav_2" class="a-MenuBar-item"><a role="menuitem" class="a-MenuBar-label"
                id="t_MenuNav_2i" href="../dim/medicine-details.html" tabindex="-1">Medicine Details</a></li>
            <li role="none" id="t_MenuNav_3" class="a-MenuBar-item"><a role="menuitem" class="a-MenuBar-label"
                id="t_MenuNav_3i" href="download.html" tabindex="-1">Download Despatched Medicine</a></li>
          </ul>
        </div>
      </div>
    </header>
    <div class="t-Body">
      <div class="t-Body-main">
        <div class="t-Body-title" id="t_Body_title"></div>
        <div class="t-Body-content" id="t_Body_content">
          <div id="t_Body_content_offset"></div>
          <main id="main" class="t-Body-mainContent">
            <span id="APEX_SUCCESS_MESSAGE" data-template-id="238562751400702882270_S"
              class="apex-page-success u-hidden"></span><span id="APEX_ERROR_MESSAGE"
              data-template-id="238562751400702882270_E" class="apex-page-error u-hidden"></span>
            <div class="t-Body-fullContent"></div>
            <div class="t-Body-contentInner">
              <div class="container">
                <div class="row ">
                  <div class="col col-6 apex-col-auto col-start">
                    <div
                      class="t-Form-fieldContainer is-required rel-col t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--indicatorAsterisk t-Form-fieldContainer--large apex-item-wrapper apex-item-wrapper--select-list"
                      id="P39_DISTRICT_CONTAINER">
                      <div class="t-Form-labelContainer col col-2">
                        <label for="P39_DISTRICT" id="P39_DISTRICT_LABEL" class="t-Form-label">District </label>
                      </div>
                      <div class="t-Form-inputContainer col col-4">
                        <div class="t-Form-itemWrapper">
                          <select id="P39_DISTRICT" name="P39_DISTRICT" required="" class="selectlist apex-item-select"
                            data-native-menu="false" size="1">
                          </select>
                        </div>
                        <div class="t-Form-itemAssistance">
                          <span id="P39_DISTRICT_error_placeholder" class="a-Form-error"
                            data-template-id="428237131064519931341_ET"></span>
                          <div class="t-Form-itemRequired" aria-hidden="true">Required</div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col col-6 apex-col-auto col-end">
                    <div
                      class="t-Form-fieldContainer is-required rel-col t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--indicatorAsterisk t-Form-fieldContainer--large apex-item-wrapper apex-item-wrapper--select-list"
                      id="P39_FINANCIAL_YEAR_CONTAINER">
                      <div class="t-Form-labelContainer col col-2">
                        <label for="P39_FINANCIAL_YEAR" id="P39_FINANCIAL_YEAR_LABEL" class="t-Form-label">Financial
                          Year </label>
                      </div>
                      <div class="t-Form-inputContainer col col-4">
                        <div class="t-Form-itemWrapper">
                          <select id="P39_FINANCIAL_YEAR" name="P39_FINANCIAL_YEAR" required=""
                            class="selectlist apex-item-select" data-native-menu="false" size="1">
                            <option value="" selected="selected"></option>
                          </select>
                        </div>
                        <div class="t-Form-itemAssistance">
                          <span id="P39_FINANCIAL_YEAR_error_placeholder" class="a-Form-error"
                            data-template-id="428237131064519931341_ET"></span>
                          <div class="t-Form-itemRequired" aria-hidden="true">Required</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row ">
                  <div class="col col-6 apex-col-auto col-start"><button class="t-Button u-color-12" type="button"
                      id="searchBtn"><span class="t-Button-label">Search</span></button></div>
                  <div class="col col-6 apex-col-auto col-end"><button class="t-Button js-ignoreChange" type="button"
                      id="clearBtn"><span class="t-Button-label">Clear</span></button></div>
                </div>
                <div class="row ">
                  <div class="col col-12 apex-col-auto col-start col-end">
                    <div id="R310533127643274873150" role="region" aria-label="Medicine Details"
                      class="t-IRR-region js-apex-region">
                      <div class="t-Region-orderBy"></div>
                      <div id="R310533127643274873150_ir" class="a-IRR-container">
                        <div id="R310533127643274873150_worksheet_region" class="a-IRR" aria-live="polite">
                          <div id="R310533127643274873150_single_row_view" class="a-IRR-singleRowView"></div>
                          <div id="R310533127643274873150_full_view" class="a-IRR-fullView">
                            <div id="R310533127643274873150_toolbar" class="a-IRR-toolbar">
                              <div role="search" aria-label="Search bar of Medicine Details"
                                id="R310533127643274873150_toolbar_controls" class="a-IRR-controls">
                                <div class="a-IRR-controlGroup a-IRR-controlGroup--search a-IRR-controlGroup--hidden">
                                  <div class="a-IRR-search"><input type="hidden"
                                      id="R310533127643274873150_column_search_current_column"><input type="hidden"
                                      id="R310533127643274873150_search_field" value=""></div>
                                </div>
                                <div class="a-IRR-controlGroup a-IRR-controlGroup--views">
                                  <div class="a-IRR-viewsContainer">
                                    <div class="a-IRR-views"><button id="R310533127643274873150_report_view"
                                        type="button" class="a-Button a-IRR-button a-IRR-button--views"
                                        data-view="report" title="View Report" aria-label="View Report"
                                        aria-pressed="false"><span class="a-Icon icon-irr-report"
                                          aria-hidden="true"></span></button><button
                                        id="R310533127643274873150_pivot_view" type="button"
                                        class="a-Button a-IRR-button a-IRR-button--views is-active" data-view="pivot"
                                        title="View Pivot" aria-label="View Pivot" aria-pressed="true"><span
                                          class="a-Icon icon-irr-pivot" aria-hidden="true"></span></button></div>
                                  </div>
                                </div>
                                <div class="a-IRR-controlGroup a-IRR-controlGroup--options">
                                  <input type="hidden" id="R310533127643274873150_row_select" value="50">
                                  <div class="a-IRR-actions"><button id="R310533127643274873150_actions_button"
                                      class="a-Button a-IRR-button a-IRR-button--actions" type="button"
                                      data-menu="R310533127643274873150_actions_menu" aria-haspopup="menu">Actions<span
                                        aria-hidden="true" class="a-Icon icon-menu-drop-down"></span></button></div>
                                </div>
                              </div>
                            </div>
                            <div id="R310533127643274873150_content" class="a-IRR-content ">
                              <div id="R310533127643274873150_dialog_js" class="a-IRR-dialogBody" style="display:none">
                              </div>
                              <input type="hidden" id="R310533127643274873150_worksheet_id"
                                value="310533127741483873150">
                              <input type="hidden" id="R310533127643274873150_app_user" value="9994793279">
                              <input type="hidden" id="R310533127643274873150_report_id" value="310533571725520116958">
                              <input type="hidden" id="R310533127643274873150_view_mode" value="PIVOT">
                              <div role="region" aria-label="Report settings of Medicine Details"
                                class="a-MediaBlock a-IRR-controlsContainer a-Collapsible is-expanded"
                                id="R310533127643274873150_control_panel">
                                <div class="a-MediaBlock-graphic">
                                  <h3 aria-hidden="true" class="u-vh a-Collapsible-heading"
                                    id="a_Collapsible1_R310533127643274873150_control_panel_heading">Report Settings
                                  </h3>
                                  <span role="heading" aria-level="3"><button type="button"
                                      class="a-Button a-IRR-button a-IRR-button--controls"
                                      aria-labelledby="a_Collapsible1_R310533127643274873150_control_panel_heading"
                                      aria-controls="a_Collapsible1_R310533127643274873150_control_panel_content"
                                      aria-expanded="true"><span class="a-Icon a-Collapsible-icon icon-down-arrow"
                                        aria-hidden="true"></span></button></span>
                                </div>
                                <div class="a-MediaBlock-content a-Collapsible-content"
                                  id="a_Collapsible1_R310533127643274873150_control_panel_content" aria-hidden="false">
                                  <ul role="none" class="a-IRR-controls">
                                    <li class="a-IRR-controls-item a-IRR-controls-item--pivot"
                                      aria-labelledby="R310533127643274873150_control_text_pivot" role="region"><span
                                        class="a-IRR-controls-cell"></span><span class="a-IRR-controls-cell"><span
                                          class="a-Icon a-IRR-controlsIcon icon-irr-pivot"
                                          aria-hidden="true"></span></span><span
                                        class="a-IRR-controls-cell a-IRR-controls-cell--label"><button type="button"
                                          id="pivotBtn" aria-describedby="R310533127643274873150_control_text_pivot"
                                          class="a-IRR-button--edit a-IRR-controlsLabel" data-setting="pivot"><span
                                            aria-hidden="true">Pivot</span><span class="u-vh">Edit
                                            Pivot</span></button></span><span
                                        class="a-IRR-controls-cell a-IRR-controls-cell--remove"><button
                                          class="a-Button a-IRR-button a-Button--noUI a-IRR-button--remove"
                                          aria-label="Remove Pivot"
                                          aria-describedby="R310533127643274873150_control_text_pivot" type="button"
                                          data-setting="pivot" id="removePivotBtn"><span aria-hidden="true"
                                            class="a-Icon icon-remove"></span><span class="u-vh" "="">Remove Pivot</span></button></span></li>
                                    </ul>
                                  </div>
                                  <div class=" a-IRR-reportSummaryContainer"
                                            id="R310533127643274873150_control_panel_summary" style="display: none;">
                                            <ul class="a-IRR-reportSummary">
                                              <li class="a-IRR-reportSummary-item a-IRR-reportSummary-item--pivot"><a
                                                  href="#" class="a-IRR-reportSummary-label" data-setting="pivot"><span
                                                    class="a-IRR-reportSummary-icon" aria-label="Pivot" role="img"><span
                                                      class="a-Icon icon-irr-pivot"></span></span><span
                                                    class="a-IRR-reportSummary-value">Edit Pivot</span></a></li>
                                            </ul>
                                </div>
                              </div>
                              <div role="region" aria-label="Chart view of Medicine Details"
                                id="R310533127643274873150_chart" class="a-IRR-chartView"></div>
                              <div role="region" aria-label="Group by view of Medicine Details"
                                id="R310533127643274873150_group_by" class="a-IRR-groupByView"></div>
                              <div role="region" aria-label="Pivot view of Medicine Details"
                                id="R310533127643274873150_pivot" class="a-IRR-pivotView">
                                <div class="a-IG-contentContainer" id="R311550531762325085781_ig_content_container"
                                  role="region" aria-label="Grid View" style="width: 1061.85px;">
                                  <table id="viewIndentDistrictTable" class="a-IRR-table" style="width:100%">
                                    <thead>
                                      <tr>
                                        <th class="a-IRR-header u-tC">
                                          <span class="a-IRR-headerLabel">Medicine Name</span>
                                          <div class="t-fht-cell"></div>
                                        </th>
                                        <th class="a-IRR-header u-tC">
                                          <span class="a-IRR-headerLabel">Packing Size</span>
                                          <div class="t-fht-cell"></div>
                                        </th>
                                        <th class="a-IRR-header u-tC">
                                          <span class="a-IRR-headerLabel">Name Of The Institution</span>
                                          <div class="t-fht-cell"></div>
                                        </th>
                                        <th class="a-IRR-header u-tC">
                                          <span class="a-IRR-headerLabel">Total Quantity</span>
                                          <div class="t-fht-cell"></div>
                                        </th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                  </table>
                                </div>
                                <div role="region" aria-label="Message" class="a-IRR-noDataMsg">
                                  <div class="a-IRR-noDataMsg-icon"><span class="a-Icon icon-irr-no-results"
                                      aria-hidden="true"></span></div>
                                  <span class="a-IRR-noDataMsg-text">No data found.</span>
                                </div>
                              </div>
                              <div role="region" aria-label="Data view of Medicine Details"
                                id="R310533127643274873150_data_panel" class="a-IRR-reportView"></div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </main>
          <footer class="t-Footer" id="t_Footer" role="contentinfo">
            <div class="t-Footer-body">
              <div class="t-Footer-content"></div>
              <div class="t-Footer-apex">
                <!-- <div class="t-Footer-version">    </div>
                    <div class="t-Footer-customize"></div>
                     -->
                <div class="row">
                  <div class="col-6">
                    <p class="text-middle"><img class="footer-logo" src="../assets/img/head-dept-logo.png"><br>Content
                      owned by Department of Indian Medicine and Homoeopathy ©</p>
                  </div>
                  <div class="col-6">
                    <p class="text-middle"><img class="footer-logo" src="../assets/img/tnegalogo.png"><br>Designed and
                      Developed by Tamil Nadu e-Governance Agency</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="t-Footer-top">
              <a href="#top" class="t-Footer-topButton" id="t_Footer_topButton" title="Start of page"
                aria-label="Start of page"><span class="a-Icon icon-up-chevron" aria-hidden="true"></span></a>
            </div>
          </footer>
        </div>
      </div>
    </div>
    <div class="t-Body-inlineDialogs" id="t_Body_inlineDialogs"></div>
    <input type="hidden" id="pPageFormRegionChecksums" value="[]">
    <input type="hidden" id="pPageItemsRowVersion" value=""><input type="hidden" id="pPageItemsProtected"
      value="/4INVCMJADMPwVW6XelDQlYDQSPvRAITU0gSDpFfpaYmuw1n9t-2t6Eir3cln704jtvCtgMO2TcnNK_oL8mkF5g">
  </form>


  <script src="../assets/js/desktop_all.min.js"></script>
  <script src="../assets/js/aos.js"></script>
  <!-- jQuery -->
  <script src="../assets/js/jquery-3.6.0.min.js"></script>
  <script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- DataTables -->
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script src="../assets/js/widget.treeView.min.js"></script>
  <script src="../assets/common.js"></script>
  <script src="../assets/js/widget.interactiveReport.min.js"></script>
  <script src="../assets/js/widget.iconList.min.js"></script>
  <script src="../assets/js/widget.stickyTableHeader.min.js"></script>
  <script src="../assets/js/widget.stickyWidget.min.js"></script>
  <script src="../assets/js/item.Colorpicker.min.js"></script>
  <script src="../assets/js/jetCommonBundle.min.js"></script>
  <script src="../assets/js/chartBundle.min.js"></script>

  <script src="../assets/js/toastUtil.js"></script>
  <script src="../assets/js/validation.js"></script>
  <script src="../assets/js/dataTableUtil.js"></script>
  <script src="../assets/js/crypto-js.min.js"></script>
  <script src="../assets/js/theme42.min.js"></script>
  <script src="../assets/js/global.js"></script>
  <script src="../assets/js/encrypt_decrypt.js"></script>
  <script src="../assets/js/singleFileUpload.js"></script>
  <script src="../assets/js/globalHeader.js"></script>
  <script src="../assets/js/validation.js"></script>
  <script>
    $(document).ready(function () {
      var userName = localStorage.getItem("userName") || "Guest";
      $('#username .t-Button-label').text(userName);
    });
  </script>
  <script>

    const apiUrl = 'https://tngis.tnega.org/medical_indent_api/v1/commonfunction';
    const mobnumber = localStorage.getItem('userMobileNumber') || "";

    function fetchAndPopulateDropdown({ payload, dropdownId, placeholder }) {
      $.ajax({
        url: apiUrl,
        method: 'POST',
        headers: {
          'X-APP-Key': 'edm',
          'X-APP-Name': 'edm'
        },
        data: {
          data: encryptData(payload)
        },
        dataType: 'json',
        success(response) {
          const decrypted = decryptData(response.data);
          console.log(`Decrypted Data for ${payload.function_name}:`, decrypted);

          const $dropdown = $(`#${dropdownId}`);
          $dropdown.empty().append(`<option value="">${placeholder}</option>`);

          decrypted.forEach(item => {
            const value = item.district || item.year || item.system || item.scheme || item.type || item.quarter;
            $dropdown.append(`<option value="${value}">${value}</option>`);
          });
        },
        error(xhr, status, error) {
          console.error(`${payload.function_name} API Error:`, error);
        }
      });
    }
    //  Make API calls
    fetchAndPopulateDropdown({
      payload: {
        action: "function_call",
        function_name: "im_own_district_fn",
        params: { null: null }
      },
      dropdownId: "P39_DISTRICT",
      placeholder: "--Select District--"
    });
    fetchAndPopulateDropdown({
      payload: {
        action: "function_call",
        function_name: "im_year_fn",
        params: {}
      },
      dropdownId: "P39_FINANCIAL_YEAR",
      placeholder: "--Select Financial Year--"
    });
    function getPayload() {
      return {
        action: "function_call",
        function_name: "im_indent_medicine_summary_fn",
        params: {
          p_district: $('#P39_DISTRICT').val() || null,
          p_financial_year: $('#P39_FINANCIAL_YEAR').val() || null
        }
      };
    }

    function fetchTableData() {
      const payload = getPayload();
      loadDataToTable({
        tableId: 'viewIndentDistrictTable',
        apiUrl,
        httpMethod: 'POST',
        payload: encryptData(payload),
        rowBuilder: (item) => {
          // console.log(item);
          return `
                  <tr>
                    <td class="u-tC">${item.medicine_name || 'N/A'}</td>
                    <td class="u-tC">${item.packing_size || 'N/A'}</td>
                    <td class="u-tC">${item.name_of_the_institution || 'N/A'}</td>
                    <td class="u-tC">${item.quantity || 'N/A'}</td>
                  </tr>
                `;
        },
        onTableInit: function (dtRef) {
          dataTableRef = dtRef;
        }
      });
    }
    $('#searchBtn').on('click', function () {
      fetchTableData();
    });
    $('#clearBtn').on('click', function () {
      $('#P39_DISTRICT').val("");
      $('#P39_FINANCIAL_YEAR').val("");
    });
    let originalThead = "";
let originalTbody = "";

document.getElementById("pivotBtn").addEventListener("click", function () {
  const table = document.getElementById("viewIndentDistrictTable");
  const dt = $('#viewIndentDistrictTable').DataTable(); // DataTable instance
  const rows = dt.rows().data().toArray(); // All data across all pages

  // Save original only once
  if (!originalThead && !originalTbody) {
    originalThead = table.querySelector("thead").innerHTML;
    originalTbody = table.querySelector("tbody").innerHTML;
  }

  const pivotMap = new Map();
  const totalMap = new Map();
  const institutionSet = new Set();

  rows.forEach(cells => {
    const med = cells[0].trim();
    const pack = cells[1].trim();
    const institution = cells[2].trim();
    const qty = parseInt(cells[3]) || 0;

    const key = `${med}|${pack}`;
    if (!pivotMap.has(key)) {
      pivotMap.set(key, {});
      totalMap.set(key, 0);
    }

    pivotMap.get(key)[institution] = (pivotMap.get(key)[institution] || 0) + qty;
    totalMap.set(key, totalMap.get(key) + qty);

    institutionSet.add(institution);
  });

  const institutions = Array.from(institutionSet).sort();

  let theadHTML = "<tr><th></th><th></th><th></th>";
  institutions.forEach(inst => {
    theadHTML += `<th>${inst}</th>`;
  });
  theadHTML += "</tr><tr>";
  theadHTML += "<th>Medicine Name</th><th>Packing Size</th><th>Total Quantity</th>";
  institutions.forEach(() => {
    theadHTML += `<th>Sum Qty</th>`;
  });
  theadHTML += "</tr>";

  let tbodyHTML = "";
  pivotMap.forEach((instData, key) => {
    const [med, pack] = key.split("|");
    const totalQty = totalMap.get(key);
    tbodyHTML += `<tr><td>${med}</td><td>${pack}</td><td>${totalQty}</td>`;
    institutions.forEach(inst => {
      tbodyHTML += `<td>${instData[inst] || ""}</td>`;
    });
    tbodyHTML += "</tr>";
  });

  // Destroy and recreate DataTable to reflect pivoted content
  dt.destroy();
  table.querySelector("thead").innerHTML = theadHTML;
  table.querySelector("tbody").innerHTML = tbodyHTML;
  $('#viewIndentDistrictTable').DataTable(); // Reinitialize
});


    document.getElementById("removePivotBtn").addEventListener("click", function () {
      const table = document.getElementById("viewIndentDistrictTable");

      if (originalThead && originalTbody) {
        table.querySelector("thead").innerHTML = originalThead;
        table.querySelector("tbody").innerHTML = originalTbody;
      }
    });

  </script>
  <div id="pushModal" style="width: 100%; display:none; height: 100%;" class="u-DisplayNone u-Overlay--glass"></div>
  <div id="R310533127643274873150_actions_menu" role="menu" class="a-Menu" style="display: none;"></div>
  <div role="dialog" aria-label="Column Actions" aria-modal="true" class="a-IRR-sortWidget"
    id="R310533127643274873150_sort_widget" style="display:none;">
    <h1 class="u-vh" aria-roledescription="Visually hidden dialog title">Column Actions</h1>
    <ul role="toolbar" class="a-IRR-sortWidget-actions" id="R310533127643274873150_sort_widget_actions">
      <li role="none" class="a-IRR-sortWidget-actions-item" id="R310533127643274873150_sort_widget_action_up"><button
          class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button" title="Sort Ascending"
          aria-label="Sort Ascending" data-option="up"><span aria-hidden="true"
            class="a-Icon icon-irr-sort-asc"></span></button></li>
      <li role="none" class="a-IRR-sortWidget-actions-item" id="R310533127643274873150_sort_widget_action_down"><button
          class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button" title="Sort Descending"
          aria-label="Sort Descending" data-option="down"><span aria-hidden="true"
            class="a-Icon icon-irr-sort-desc"></span></button></li>
      <li role="none" class="a-IRR-sortWidget-actions-item" id="R310533127643274873150_sort_widget_action_hide"><button
          class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button" title="Hide Column"
          aria-label="Hide Column" data-option="hide"><span aria-hidden="true"
            class="a-Icon icon-irr-remove-col"></span></button></li>
      <li role="none" class="a-IRR-sortWidget-actions-item" id="R310533127643274873150_sort_widget_action_break"><button
          class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button" title="Control Break"
          aria-label="Control Break" data-option="break"><span aria-hidden="true"
            class="a-Icon icon-irr-control-break"></span></button></li>
      <li role="none" class="a-IRR-sortWidget-actions-item" id="R310533127643274873150_sort_widget_action_help"><button
          class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button" title="Help" aria-label="Help"
          data-option="help" aria-pressed="false"><span aria-hidden="true" class="a-Icon icon-irr-help"></span></button>
      </li>
      <li role="none" class="a-IRR-sortWidget-actions-item" id="R310533127643274873150_sort_widget_action_computation">
        <button class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button" title="Compute" aria-label="Compute"
          data-option="computation"><span aria-hidden="true" class="a-Icon icon-irr-calculator"></span></button>
      </li>
    </ul>
    <div role="region" aria-label="Help" class="a-IRR-sortWidget-help" id="R310533127643274873150_sort_widget_help">
    </div>
    <div role="search" class="a-IRR-sortWidget-search" id="R310533127643274873150_sort_widget_search">
      <label for="R310533127643274873150_sort_widget_search_field" class="a-IRR-sortWidget-searchLabel"><span
          class="u-vh">Search</span></label><input id="R310533127643274873150_sort_widget_search_field"
        class="a-IRR-sortWidget-searchField" type="text" placeholder="Filter...">
      <div role="group" aria-label="Filter suggestions" class="a-IRR-sortWidget-rows"
        id="R310533127643274873150_sort_widget_rows"></div>
    </div>
  </div>
  <div class="t-NavigationBar-menu a-Menu" style="display: none" id="menu_L428237300758551931558" role="menu">
    <ul>
      <li class="" data-current="false" data-icon="fa fa-sign-out"><a
          href="apex_authentication.logout?p_app_id=117&amp;p_session_id=2368821413423" title="" target="">Sign Out</a>
      </li>
    </ul>
  </div>
  <iframe frameborder="0" scrolling="no" style="background-color: transparent; border: 0px; display: none;"></iframe>
  <div id="GOOGLE_INPUT_CHEXT_FLAG" style="display: none;" input=""
    input_stat="{&quot;tlang&quot;:true,&quot;tsbc&quot;:true,&quot;pun&quot;:true,&quot;mk&quot;:true,&quot;ss&quot;:true}">
  </div>
</body>

</html>